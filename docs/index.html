<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.js" integrity="sha512-+k1pnlgt4F1H8L7t3z95o3/KO+o78INEcXTbnoJQ/F2VqDVhWoaiVml/OEHv9HsVgxUaVW+IbiZPUJQfF/YxZw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://kit.fontawesome.com/7d94912b47.js" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/cgview/dist/cgview.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cgview/dist/cgview.css">
    <title>PUMAS by Luan Rabelo</title>
    <meta name="title" content="PUMAS" />
    <meta name="description" content="PUMAS: Puzzle Mitochondrial (and Chloroplast) Analysis Script" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://luanrabelo.github.io/PUMAS/" />
    <meta property="og:title" content="PUMAS" />
    <meta property="og:description" content="PUMAS: Puzzle Mitochondrial (and Chloroplast) Analysis Script" />
    <meta property="og:image" content="https://raw.githubusercontent.com/luanrabelo/PUMAS/master/docs/assets/PUMASsm.png" />

    <meta property="twitter:card" content="https://raw.githubusercontent.com/luanrabelo/PUMAS/master/docs/assets/PUMAS.png" />
    <meta property="twitter:url" content="https://luanrabelo.github.io/PUMAS/" />
    <meta property="twitter:title" content="PUMAS" />
    <meta property="twitter:description" content="PUMAS: Puzzle Mitochondrial (and Chloroplast) Analysis Script" />
    <meta property="twitter:image" content="https://raw.githubusercontent.com/luanrabelo/PUMAS/master/docs/assets/PUMASsm.png" />
</head>

<style>
    * {
        font-family: "Montserrat", sans-serif;
    }
    main {
        position: relative;
        height: auto;
    }
    sup {
        font-size: 0.35em;
        vertical-align: super;
        font-weight: 400;
    }
    a {
        color: #DDDDDD;
        text-decoration: none;
    }
    a:hover {
        color: #EE4E4E;
        text-decoration: underline;
    }
    hr {
        border: 0;
        clear: both;
        display: block;
        width: 100%;
        background-color: #dee2e6;
        height: 2.5px;
    }
    .form-check-label {
        font-size: 1.25em;
        padding: 0 10px 10px 10px;
    }
    .form-check-input:checked {
        background-color: #9dde8b;
        border-color: #9dde8b;
        width: 2.5em;
        height: 1.5em;
        vertical-align: middle;
    }
    .form-check-input:not(:checked) {
        background-color: #ff7f3e;
        border-color: #ff7f3e;
        width: 2.5em;
        height: 1.5em;
        vertical-align: middle;
    }
    .progress-bar {
        background-color: #ff9800;
        color: #000000;
        font-size: 1.5em;
    }
    .gene-path:hover {
        cursor: pointer;
    }
    .full-screen {
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    #LinearGenome {
        width: 75%;
        height: 75%;
        margin: 0 auto;

    }

    
</style>
<body class="bg-light container-fluid">
    <!-- Modal -->
    <div class="modal fade" id="LoadingPumas" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header h3 bg-dark text-white">PUMAS</div>
                <div class="modal-body text-center">
                    <figure class="figure">
                        <img src="assets/PUMAS.png" class="figure-img img-fluid rounded" alt="..." width="50%">
                        <div class="h4"><b>Pu</b>zzle <b>M</b>itochondrial (and Chloroplast) <b>A</b>nalysis <b>S</b>cript</div>
                    </figure>
                    <div class="progress">
                        <div id="progressBar" class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
                    </div>
                </div>
                <div class="modal-footer bg-dark text-white">
                    <div class="h3">Please wait...</div>
                </div>
            </div>
        </div>
    </div>
    <main>
        <div class="container full-screen text-center">
            <div class="row align-items-center">
                <div class="col-md-6 text-center">
                    <img src="assets/PUMAS.png" class="img-fluid" alt="PUMAS">
                </div>
            <div class="col-md-6 d-flex align-items-center">
                <div>
                    <div class="display-2">PUMAS<sup>by Luan Rabelo</sup></div>
                    <div class="h3"><b>Pu</b>zzle <b>M</b>itochondrial (and Chloroplast) <b>A</b>nalysis <b>S</b>cript</div>
                    <div class="h5 mt-5">How to Cite PUMAS: Coming Soonâ€¦</div>
                    <div class="mt-5">
                        <i style="cursor: pointer;" id="btnStartPUMAS" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-custom-class="custom-tooltip" data-bs-html="true" data-bs-title="Click to Start PUMAS" class="fa-solid fa-circle-arrow-down fa-fade fa-4x"></i>
                    </div>
                </div>
              </div>
            </div>
        </div>
        <script>
            $(document).ready(function () {
                const btnStartPUMAS = $('#btnStartPUMAS');
                btnStartPUMAS.click(function () {
                    const formPUMASPosition = $('.formPUMAS').offset().top;
                    $('html, body').animate({
                    scrollTop: formPUMASPosition
                    }, 1000);
                });
            });
        </script>
        <div class="mt-5 mb-2 mx-auto container-fluid formPUMAS">
            <div class="mb-1 container">
                <label for="vouchersList" class="h4"><span class="badge text-bg-dark">1</span> - Please insert the list of GenBank Accession Numbers genomes</label><br>
                <small id="infoText" class="text-muted"><i class="fa-solid fa-circle-info"></i> For a robust search for genomes in GenBank, we recommend to the use <b><a style="color: #000000;" href="https://luanrabelo.github.io/SynGenes" target="_blank">SynGenes</a></b>.</small><br>
                <small id="infoText" class="text-muted"><i class="fa-solid fa-circle-info"></i> How to cite SynGenes: <b><a style="color: #000000;" href="https://doi.org/10.1186/s12859-024-05781-y" target="_blank">https://doi.org/10.1186/s12859-024-05781-y</a></b></small>
                <textarea class="form-control" placeholder="" id="vouchersList" style="height: 20vh" spellcheck="false"></textarea>
                <div id="errorDiv" class="text-danger mt-1"></div>
                <div class="text-left mt-1" style="text-align: justify; line-height: 2;">
                    <p>
                        <small id="infoText" class="text-muted">
                            <i class="fa-solid fa-circle-info"></i> Enter the <strong>NCBI - GenBank Accession Numbers for Mitochondrial or Chloroplast Genomes</strong> in the space provided above.
                        </small>
                    </p>
                    <p>
                        <small id="infoText" class="text-muted">
                            <i class="fa-solid fa-circle-info"></i> Each Accession Number should be on a <strong>distinct line without any blank lines in between</strong>.
                        </small>
                    </p>
                    <p>
                        <small id="infoText" class="text-muted">
                            <i class="fa-solid fa-circle-info"></i> Click in <button type="button" id="exampleVouchersMitochondrial" class="btn btn-sm btn-dark" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-custom-class="custom-tooltip" data-bs-html="true" data-bs-title="Potamiscine with <b>17 genomes</b> from Zhang et. al. 2020">Mitochondrial</button> or <button type="button" id="exampleVouchersChloroplast" class="btn btn-sm btn-dark" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-custom-class="custom-tooltip" data-bs-html="true" data-bs-title="Coffea Genus with <b>23 genomes</b>">Chloroplast</button> to see an example </button> or <button class="btn btn-sm btn-danger" type="button" id="resetVouchers" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-custom-class="custom-tooltip" data-bs-html="true" data-bs-title="Clear all the list and <b>Start</b> again">Click here</button> to clear the list above.
                        </small>
                    </p>
                </div>
                <script>
                    $(document).ready(function () {
                        const vouchers              = document.getElementById('vouchersList');
                        const mt                    = document.getElementById('mt');
                        const cp                    = document.getElementById('cp');
                        const startSearch           = document.getElementById('startSearch');
                        const exampleMitochondrial  = document.getElementById('exampleVouchersMitochondrial');
                        const exampleChloroplast    = document.getElementById('exampleVouchersChloroplast');
                        const resetVouchers         = document.getElementById('resetVouchers');
                
                        vouchers.addEventListener('input', function () {
                            const lines = vouchers.value.split('\n');
                            var errorLine = -1;
                            var errorMessage = '';
                            const errorDiv = document.getElementById('errorDiv');
                            var charError = '';
                            const voucherSet = new Set();
                            if (lines.length === 1 && lines[0] === '') {
                                vouchers.style.backgroundColor = '';
                                errorDiv.innerHTML = '';
                                return;
                            }
                            for (let i = 0; i < lines.length; i++) {
                                if (!/^[a-zA-Z0-9_.]+$/.test(lines[i])) {
                                    charError = 'Invalid characters detected';
                                } else if (!/\.\d+$/.test(lines[i])) {
                                    charError = 'Line must end with a . followed by a number';
                                } else if (voucherSet.has(lines[i])) {
                                    charError = 'Duplicate Accession Number detected';
                                } else if (lines[i].length < 5 || lines[i].length > 15) {
                                    charError = 'Invalid Accession Number length';
                                }
                                if (charError) {
                                    errorLine = i + 1;
                                    errorMessage = `Invalid input in line ${errorLine}: ${charError}. Please fix it before proceeding.`;
                                    break;
                                }
                                voucherSet.add(lines[i]);
                            }
                            if (errorLine !== -1) {
                                vouchers.style.backgroundColor = '#FF7F3E';
                                errorDiv.innerHTML = errorMessage;
                                mt.disabled = true;
                                cp.disabled = true;
                            } else {
                                vouchers.style.backgroundColor = '#9DDE8B';
                                errorDiv.innerHTML = '';
                                mt.disabled = false;
                                cp.disabled = false;
                            }
                        });
                
                        resetVouchers.addEventListener('click', function () {
                            vouchers.value = "";
                            const event = new Event('input', {
                                bubbles: true,
                                cancelable: true,
                            });
                            vouchers.dispatchEvent(event);
                            
                            const cds       = document.getElementById('CDS');
                            const rRNAs     = document.getElementById('rRNA');
                            const tRNAs     = document.getElementById('tRNA');
                            const geneList  = document.getElementById('geneList');
                            const _results  = document.getElementById('PUMASResults');
                            const svgPlot   = document.getElementById('svgPlot');
                            const Patterns  = document.getElementById('Patterns');
                            geneList.value                  = 'NaN';
                            mt.checked                      = false;
                            mt.disabled                     = true;
                            cp.checked                      = false;
                            cp.disabled                     = true;
                            Patterns.checked                = false;
                            startSearch.disabled            = true;
                            cds.checked                     = false;
                            cds.disabled                    = true;
                            rRNAs.checked                   = false;
                            rRNAs.disabled                  = true;
                            tRNAs.checked                   = false;
                            tRNAs.disabled                  = true;
                            geneList.disabled               = true;
                            geneList.style.backgroundColor  = '';
                            _results.style.display          = 'none';
                        });
                
                        exampleMitochondrial.addEventListener('click', function () {
                            const _vouchers = ["MN737137.1", "MN737145.1", "AB187570.1", "MN737141.1", "MN737139.1", "MN737143.1", "MN737144.1", "MN737133.1", "MN737138.1", "MN737136.1", "MN737142.1", "MN737134.1", "KU042041.1", "KY785880.1", "KY785879.1", "MN737132.1", "MN737140.1"];
                            vouchers.value = "";
                            _vouchers.forEach((s, i) => setTimeout(() => {
                                vouchers.value += s + (i < _vouchers.length - 1 ? "\n" : "");
                            }, i * 1));
                            setTimeout(() => {
                                const event = new Event('input', {
                                    bubbles: true,
                                    cancelable: true,
                                });
                                vouchers.dispatchEvent(event);
                            }, _vouchers.length * 1);
                            mt.checked = false;
                            cp.checked = false;
                        });
                        exampleChloroplast.addEventListener('click', function () {
                            const _vouchers = ["PP708565.1", "NC_079620.1", "NC_079619.1", "NC_079618.1", "MN901638.1", "ON117418.1", "ON101708.1", "ON101707.1", "NC_030053.1", "NC_008535.1", "OL789882.1", "MW970412.1", "MW970411.1", "MN894552.1", "MN894551.1", "MN894550.1", "MK875244.1", "MK862266.1", "MK353212.1", "MK353209.1", "MK342634.1", "EF044213.1", "MN370912.1"];
                            vouchers.value = "";
                            _vouchers.forEach((s, i) => setTimeout(() => {
                                vouchers.value += s + (i < _vouchers.length - 1 ? "\n" : "");
                            }, i * 1));
                
                            setTimeout(() => {
                                const event = new Event('input', {
                                    bubbles: true,
                                    cancelable: true,
                                });
                                vouchers.dispatchEvent(event);
                            }, _vouchers.length * 1);
                            mt.checked = false;
                            cp.checked = false;
                        });
                    });
                </script>
            </div>
            <hr class="mt-2">
            <div class="row row-cols-1 row-cols-sm-1 row-cols-md-3 row-cols-lg-3 row-cols-xl-3 row-cols-xxl-3 container mx-auto">
                <div class="col mt-2">
                    <label class="h4"><span class="badge text-bg-dark">2</span> - What analysis to perform?</label>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" role="switch" id="mt" value="Mitochondrial" disabled>
                        <label class="form-check-label ml-2 mr-2" for="mt">Mitochondrial analysis</label>
                    </div>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" role="switch" id="cp" value="Chloroplast" disabled>
                        <label class="form-check-label ml-2 mr-2" for="cp">Chloroplast analysis</label>
                    </div>
                </div>
                <script>
                    $(document).ready(function () {
                        const mt = document.getElementById('mt');
                        const cp = document.getElementById('cp');
                        const startSearch = document.getElementById('startSearch');

                        const cds           = document.getElementById('CDS');
                        const rRNA          = document.getElementById('rRNA');
                        const tRNA          = document.getElementById('tRNA');

                        function toggleInputs(disableMt, disableCp, disableOthers) {
                            mt.disabled     = disableMt;
                            cp.disabled     = disableCp;
                            cds.disabled    = disableOthers;
                            rRNA.disabled   = disableOthers;
                            tRNA.disabled   = disableOthers;
                        }
                        mt.addEventListener('change', function () {
                            if (mt.checked) {
                                toggleInputs(false, true, false);
                            } else {
                                toggleInputs(false, false, true);
                            }
                        });
                        cp.addEventListener('change', function () {
                            if (cp.checked) {
                                toggleInputs(true, false, false);
                            } else {
                                toggleInputs(false, false, true);
                            }
                        });
                    });
                </script>
                <div class="col mt-2">
                    <label class="h4"><span class="badge text-bg-dark">3</span> - <b>Gene(s) types</b> for analysis</label>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" value="CDS" id="CDS" disabled>
                        <label class="form-check-label" for="CDS">CDS</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" value="rRNA" id="rRNA" disabled>
                        <label class="form-check-label" for="rRNAs">rRNAs</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" value="tRNA" id="tRNA" disabled>
                        <label class="form-check-label" for="rRNAs">tRNAs</label>
                    </div>
                </div>
                <script>
                    $(document).ready(function () {
                        const cds       = document.getElementById('CDS');
                        const rRNAs     = document.getElementById('rRNA');
                        const tRNAs     = document.getElementById('tRNA');
                        const geneList  = document.getElementById('geneList');

                        const mt = document.getElementById('mt');
                        const cp = document.getElementById('cp');

                        geneList.disabled = true;

                        const _mtGenes = {
                            "CDS": ["COI", "COII", "COIII", "CYTB", "ND1", "ND2", "ND3", "ND4", "ND4L", "ND5", "ND6", "ATP6", "ATP8"].sort(),
                            "rRNA": ["12S", "16S"].sort(),
                            "tRNA": ["Ala", "Arg", "Asn", "Asp", "Cys", "Gln", "Glu", "Gly", "His", "Ile", "Leu", "Lys", "Met", "Phe", "Pro", "Ser", "Thr", "Trp", "Tyr", "Val"].sort(),
                        };

                        const _cpGenes = {
                            "CDS": ["atpA", "atpB", "atpE", "atpF", "atpH", "atpI", "petA", "petB", "petD", "petE", "petG", "petL", "petN", "ndhA", "ndhB", "ndhC", "ndhD", "ndhE", "ndhF", "ndhG", "ndhH", "ndhI", "ndhJ", "ndhK", "psaA", "psaB", "psaC", "psaI", "psaJ", "psaM", "psb30", "psbA", "psbB", "psbC", "psbD", "psbE", "psbF", "psbH", "psbI", "psbJ", "psbK", "psbL", "psbM", "psbN", "psbZ", "accD", "ccsA", "cemA", "chlB", "chlL", "chlN", "clpP", "clpP1", "cysA", "cysT", "ftsH", "infA", "lhbA", "matK", "pafI", "pafII", "pbf1", "psb30", "ycf1", "ycf2", "ycf3", "ycf4", "ycf12", "ycf15"].sort(),
                            "rRNA": ["rrn16S", "rrn23S", "rrn4.5S", "rrn5S", "rpoA", "rpoB", "rpoC1", "rpoC2", "rpl2", "rpl14", "rpl16", "rpl20", "rpl22", "rpl23", "rpl32", "rpl33", "rpl36", "rps2", "rps3", "rps4", "rps7", "rps8", "rps11", "rps12", "rps14", "rps15", "rps16", "rps18", "rps19"].sort(),
                            "tRNA": ["Ala", "Arg", "Asn", "Asp", "Cys", "Gln", "Glu", "Gly", "His", "Ile", "Leu", "Lys", "Met", "Phe", "Pro", "Ser", "Thr", "Trp", "Tyr", "Val"].sort(),
                            }

                        function updateGeneList() {
                            $('#geneList').empty();
                            $('#geneList').append($('<option>').text('Choose a gene').attr('value', 'NaN'));
                            ['CDS', 'rRNA', 'tRNA'].forEach(function (type) {
                                if (document.getElementById('CDS').checked || document.getElementById('rRNA').checked || document.getElementById('tRNA').checked) {
                                    geneList.disabled = false;
                                    geneList.style.backgroundColor = '';
                                } else {
                                    geneList.disabled = true;
                                    geneList.style.backgroundColor = '';
                                }
                                if (document.getElementById(type).checked) {
                                    $('#geneList').append($('<optgroup label="' + type + '">'));
                                        if (mt.checked){
                                        $.each(_mtGenes[type], function (i, gene) {
                                            $('#geneList').append($('<option>').text(gene).attr('value', gene));
                                        });
                                    } else if (cp.checked){
                                        $.each(_cpGenes[type], function (i, gene) {
                                            $('#geneList').append($('<option>').text(gene).attr('value', gene));
                                        });
                                    }
                                    $('#geneList').append($('</optgroup>'));
                                }
                            });
                        }
                        cds.addEventListener('change', updateGeneList);
                        rRNAs.addEventListener('change', updateGeneList);
                        tRNAs.addEventListener('change', updateGeneList);
                    });
                </script>
                <div class="col mt-2">
                    <label class="h4"><span class="badge text-bg-dark">4</span> - Start <b>Genome Order</b> at:</label>
                    <select class="form-select form-select-lg" id="geneList" disabled></select>
                </div>
                <script>
                    $(document).ready(function () {
                        const geneList      = document.getElementById('geneList');
                        const startSearch   = document.getElementById('startSearch');
                        geneList.addEventListener('change', function () {
                            if (geneList.value !== 'NaN') {
                                geneList.style.backgroundColor = '#9DDE8B';
                                startSearch.disabled = false;
                            } else {
                                geneList.style.backgroundColor = '#FF7F3E';
                                startSearch.disabled = true;
                            }
                        });
                    });
                </script>

            </div>
            <div class="mt-2 text-center">
                <div class="d-grid gap-2 col-xs-12 col-sm-12 col-sm-8 col-lg-6 mx-auto">
                    <button id="startSearch" class="btn btn-lg btn-dark text-center" type="button" disabled><i class="fa-solid fa-magnifying-glass"></i> Run PUMAS</button>
                </div>
            </div>
            <script>
                $(document).ready(function () {
                    let data = null;
                    const startSearch = document.getElementById('startSearch');
                    startSearch.addEventListener('click', async function () {
                        const vouchersList  = document.getElementById('vouchersList').value.trim();
                        const geneStart     = document.getElementById('geneList').value;
                        const typeGenome    = document.getElementById('mt').checked ? 'Mitochondrial' : 'Chloroplast';
                        const genelist      = ['CDS', 'rRNA', 'tRNA'].filter(gene => document.getElementById(gene).checked);
                        const Patterns      = document.getElementById('Patterns');
                        var _geneListEdit = null;
                        if (!vouchersList) {
                            alert('Enter the GenBank Vouchers');
                            return;
                        }
                        let cdsList = null;
                        if (typeGenome === 'Mitochondrial') {
                            _geneListEdit = ['COI', 'COII', 'COIII', 'CYTB', 'ND1', 'ND2', 'ND3', 'ND4', 'ND4L', 'ND5', 'ND6', 'ATP6', 'ATP8', '12S', '16S', 'Ala', 'Arg', 'Asn', 'Asp', 'Cys', 'Gln', 'Glu', 'Gly', 'His', 'Ile', 'Leu', 'Lys', 'Met', 'Phe', 'Pro', 'Ser', 'Thr', 'Trp', 'Tyr', 'Val'];
                            cdsList = ['ATP6', 'ATP8', 'COI', 'COII', 'COIII', 'CYTB', 'ND1', 'ND2', 'ND3', 'ND4', 'ND4L', 'ND5', 'ND6'].sort();
                        } else if (typeGenome === 'Chloroplast') {
                            _geneListEdit = ['atpA', 'atpB', 'atpE', 'atpF', 'atpH', 'atpI', 'petA', 'petB', 'petD', 'petE', 'petG', 'petL', 'petN', 'ndhA', 'ndhB', 'ndhC', 'ndhD', 'ndhE', 'ndhF', 'ndhG', 'ndhH', 'ndhI', 'ndhJ', 'ndhK', 'psaA', 'psaB', 'psaC', 'psaI', 'psaJ', 'psaM', 'psb30', 'psbA', 'psbB', 'psbC', 'psbD', 'psbE', 'psbF', 'psbH', 'psbI', 'psbJ', 'psbK', 'psbL', 'psbM', 'psbN', 'psbZ', 'accD', 'ccsA', 'cemA', 'chlB', 'chlL', 'chlN', 'clpP', 'clpP1', 'cysA', 'cysT', 'ftsH', 'infA', 'lhbA', 'matK', 'pafI', 'pafII', 'pbf1', 'psb30', 'ycf1', 'ycf2', 'ycf3', 'ycf4', 'ycf12', 'ycf15', 'rrn16S', 'rrn23S', 'rrn4.5S', 'rrn5S', 'rpoA', 'rpoB', 'rpoC1', 'rpoC2', 'rpl2', 'rpl14', 'rpl16', 'rpl20', 'rpl22', 'rpl23', 'rpl32', 'rpl33', 'rpl36', 'rps2', 'rps3', 'rps4', 'rps7', 'rps8', 'rps11', 'rps12', 'rps14', 'rps15', 'rps16', 'rps18', 'rps19', 'Ala', 'Arg', 'Asn', 'Asp', 'Cys', 'Gln', 'Glu', 'Gly', 'His', 'Ile', 'Leu', 'Lys', 'Met', 'Phe', 'Pro', 'Ser', 'Thr', 'Trp', 'Tyr', 'Val'];
                            cdsList = ['atpA', 'atpB', 'atpE', 'atpF', 'atpH', 'atpI', 'petA', 'petB', 'petD', 'petE', 'petG', 'petL', 'petN', 'ndhA', 'ndhB', 'ndhC', 'ndhD', 'ndhE', 'ndhF', 'ndhG', 'ndhH', 'ndhI', 'ndhJ', 'ndhK', 'psaA', 'psaB', 'psaC', 'psaI', 'psaJ', 'psaM', 'psb30', 'psbA', 'psbB', 'psbC', 'psbD', 'psbE', 'psbF', 'psbH', 'psbI', 'psbJ', 'psbK', 'psbL', 'psbM', 'psbN', 'psbZ', 'accD', 'ccsA', 'cemA', 'chlB', 'chlL', 'chlN', 'clpP', 'clpP1', 'cysA', 'cysT', 'ftsH', 'infA', 'lhbA', 'matK', 'pafI', 'pafII', 'pbf1', 'psb30', 'ycf1', 'ycf2', 'ycf3', 'ycf4', 'ycf12', 'ycf15', 'rrn16S', 'rrn23S', 'rrn4.5S', 'rrn5S', 'rpoA', 'rpoB', 'rpoC1', 'rpoC2', 'rpl2', 'rpl14', 'rpl16', 'rpl20', 'rpl22', 'rpl23', 'rpl32', 'rpl33', 'rpl36', 'rps2', 'rps3', 'rps4', 'rps7', 'rps8', 'rps11', 'rps12', 'rps14', 'rps15', 'rps16', 'rps18', 'rps19']
                        } else {
                            alert('Select the type of genome');
                            return;
                        }
                        $('#LoadingPumas').modal('show');
                        const vouchers = vouchersList.split('\n').map(s => s.trim()).filter(s => s.length > 0);
                        data = await fetchGenomicData(vouchers, genelist, typeGenome, geneStart);
                        $('#LoadingPumas').modal('hide');
                        if (typeGenome) {
                            data.sort((a, b) => {
                                const speciesA = Array.isArray(a.speciesNames) ? a.speciesNames.join(", ") : a.speciesNames;
                                const speciesB = Array.isArray(b.speciesNames) ? b.speciesNames.join(", ") : b.speciesNames;
                                return speciesA.localeCompare(speciesB);
                            });
                            createSVG(data, geneStart, _geneListEdit, Patterns.checked);
                            if (typeGenome === 'Mitochondrial' || typeGenome === 'Chloroplast') {
                                showResults(data, typeGenome);
                            }
                        } else {
                            alert('Select the type of genome');
                        }
                    });
            
                    const Patterns = document.getElementById('Patterns');
                    Patterns.addEventListener('change', function () {
                        const typeGenome    = document.getElementById('mt').checked ? 'Mitochondrial' : 'Chloroplast';
                        if (typeGenome === 'Mitochondrial') {
                            _geneListEdit = ['COI', 'COII', 'COIII', 'CYTB', 'ND1', 'ND2', 'ND3', 'ND4', 'ND4L', 'ND5', 'ND6', 'ATP6', 'ATP8', '12S', '16S', 'Ala', 'Arg', 'Asn', 'Asp', 'Cys', 'Gln', 'Glu', 'Gly', 'His', 'Ile', 'Leu', 'Lys', 'Met', 'Phe', 'Pro', 'Ser', 'Thr', 'Trp', 'Tyr', 'Val'];
                        } else if (typeGenome === 'Chloroplast') {
                            _geneListEdit = ['atpA', 'atpB', 'atpE', 'atpF', 'atpH', 'atpI', 'petA', 'petB', 'petD', 'petE', 'petG', 'petL', 'petN', 'ndhA', 'ndhB', 'ndhC', 'ndhD', 'ndhE', 'ndhF', 'ndhG', 'ndhH', 'ndhI', 'ndhJ', 'ndhK', 'psaA', 'psaB', 'psaC', 'psaI', 'psaJ', 'psaM', 'psb30', 'psbA', 'psbB', 'psbC', 'psbD', 'psbE', 'psbF', 'psbH', 'psbI', 'psbJ', 'psbK', 'psbL', 'psbM', 'psbN', 'psbZ', 'accD', 'ccsA', 'cemA', 'chlB', 'chlL', 'chlN', 'clpP', 'clpP1', 'cysA', 'cysT', 'ftsH', 'infA', 'lhbA', 'matK', 'pafI', 'pafII', 'pbf1', 'psb30', 'ycf1', 'ycf2', 'ycf3', 'ycf4', 'ycf12', 'ycf15', 'rrn16S', 'rrn23S', 'rrn4.5S', 'rrn5S', 'rpoA', 'rpoB', 'rpoC1', 'rpoC2', 'rpl2', 'rpl14', 'rpl16', 'rpl20', 'rpl22', 'rpl23', 'rpl32', 'rpl33', 'rpl36', 'rps2', 'rps3', 'rps4', 'rps7', 'rps8', 'rps11', 'rps12', 'rps14', 'rps15', 'rps16', 'rps18', 'rps19', 'Ala', 'Arg', 'Asn', 'Asp', 'Cys', 'Gln', 'Glu', 'Gly', 'His', 'Ile', 'Leu', 'Lys', 'Met', 'Phe', 'Pro', 'Ser', 'Thr', 'Trp', 'Tyr', 'Val'];
                        } else {
                            alert('Select the type of genome');
                            return;
                        }

                        if (data) {
                            createSVG(data, document.getElementById('geneList').value, _geneListEdit, Patterns.checked);
                        }
                    });
                    const downloadFasta     = document.getElementById('downloadFasta');
                    const genesToFasta      = document.getElementById('genesToFasta');
                        genesToFasta.addEventListener('change', function () {
                            downloadFasta.disabled = genesToFasta.value === 'NaN';
                        });
                        downloadFasta.addEventListener('click', function () {
                        const _genesToFasta = document.getElementById('genesToFasta').value;
                        const _data = Object.keys(data);
                        const typeGenome = document.getElementById('mt').checked ? 'Mitochondrial' : 'Chloroplast';

                        let cdsList = null;

                        if (typeGenome === 'Mitochondrial') {
                            cdsList = ['ATP6', 'ATP8', 'COI', 'COII', 'COIII', 'CYTB', 'ND1', 'ND2', 'ND3', 'ND4', 'ND4L', 'ND5', 'ND6'].sort();
                        } else if (typeGenome === 'Chloroplast') {
                            cdsList = ['atpA', 'atpB', 'atpE', 'atpF', 'atpH', 'atpI', 'petA', 'petB', 'petD', 'petE', 'petG', 'petL', 'petN', 'ndhA', 'ndhB', 'ndhC', 'ndhD', 'ndhE', 'ndhF', 'ndhG', 'ndhH', 'ndhI', 'ndhJ', 'ndhK', 'psaA', 'psaB', 'psaC', 'psaI', 'psaJ', 'psaM', 'psb30', 'psbA', 'psbB', 'psbC', 'psbD', 'psbE', 'psbF', 'psbH', 'psbI', 'psbJ', 'psbK', 'psbL', 'psbM', 'psbN', 'psbZ', 'accD', 'ccsA', 'cemA', 'chlB', 'chlL', 'chlN', 'clpP', 'clpP1', 'cysA', 'cysT', 'ftsH', 'infA', 'lhbA', 'matK', 'pafI', 'pafII', 'pbf1', 'psb30', 'ycf1', 'ycf2', 'ycf3', 'ycf4', 'ycf12', 'ycf15', 'rrn16S', 'rrn23S', 'rrn4.5S', 'rrn5S', 'rpoA', 'rpoB', 'rpoC1', 'rpoC2', 'rpl2', 'rpl14', 'rpl16', 'rpl20', 'rpl22', 'rpl23', 'rpl32', 'rpl33', 'rpl36', 'rps2', 'rps3', 'rps4', 'rps7', 'rps8', 'rps11', 'rps12', 'rps14', 'rps15', 'rps16', 'rps18', 'rps19']
                        }

                        if (_genesToFasta === "allCDS") {
                            let geneData = cdsList.reduce((acc, gene) => {
                                acc[gene] = '';
                                return acc;
                            }, {});
                            _data.forEach(id => {
                                const seq = data[id].geneSequences;
                                const speciesName = data[id].speciesNames;
                                cdsList.forEach(gene => {
                                    if (seq.hasOwnProperty(gene)) {
                                        geneData[gene] += `>${data[id].vouchers} ${speciesName}\n${seq[gene]}\n`;
                                    }
                                });
                            });

                            cdsList.forEach(gene => {
                                if (geneData[gene]) {
                                    downloadIndividualGene(gene, geneData[gene]);
                                }
                            });
                        } else if (cdsList.includes(_genesToFasta)) {
                            let dataSeq = '';
                            _data.forEach(id => {
                                const seq = data[id].geneSequences;
                                if (seq.hasOwnProperty(_genesToFasta)) {
                                    const speciesName = data[id].speciesNames;
                                    dataSeq += `>${data[id].vouchers} ${speciesName}\n${seq[_genesToFasta]}\n`;
                                }
                            });
                            downloadIndividualGene(_genesToFasta, dataSeq);
                        }
                    });

                    function downloadIndividualGene(geneName, dataSeq) {
                        const blob = new Blob([dataSeq], { type: 'text/plain' });
                        const url = window.URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = `PUMAS_${geneName}.fasta`;
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                    }
                    const downloadInputFile = document.getElementById('downloadInputFile');
                    const createInputFile = document.getElementById('createInputFile');

                    createInputFile.addEventListener('change', function () {
                        downloadInputFile.disabled = createInputFile.value === 'NaN';
                    });

                    downloadInputFile.addEventListener('click', function () {
                        let geneOrderCounts = {};

                        const geneMapQmgr = {
                            'CR': 'D-loop',
                            '-CR': '-D-loop',

                            '12S': '12S', '-12S': '-12S',
                            '16S': '16S', '-16S': '-16S',

                            'ATP6': 'ATP6', '-ATP6': '-ATP6',
                            'ATP8': 'ATP8', '-ATP8': '-ATP8',

                            'COI': 'COX1', '-COI': '-COX1',
                            'COII': 'COX2', '-COII': '-COX2',
                            'COIII': 'COX3', '-COIII': '-COX3',

                            'ND1': 'ND1', '-ND1': '-ND1',
                            'ND2': 'ND2', '-ND2': '-ND2',
                            'ND3': 'ND3', '-ND3': '-ND3',
                            'ND4L': 'ND4L', 'ND4': 'ND4', '-ND4L': '-ND4L', '-ND4': '-ND4',
                            'ND5': 'ND5', 'ND6': 'ND6', '-ND5': '-ND5', '-ND6': '-ND6',

                            'CYTB': 'CYTB', '-CYTB': '-CYTB',

                            'Ala': 'A', '-Ala': '-A', 
                            'Arg': 'R', '-Arg': '-R',
                            'Asn': 'N', '-Asn': '-N',
                            'Asp': 'D', '-Asp': '-D',
                            'Cys': 'C', '-Cys': '-C',
                            'Gln': 'Q', '-Gln': '-Q',
                            'Glu': 'E', '-Glu': '-E',
                            'Gly': 'G', '-Gly': '-G',
                            'His': 'H', '-His': '-H',
                            'Ile': 'I', '-Ile': '-I',
                            'Leu': 'L?', '-Leu': '-L?',
                            'Lys': 'K', '-Lys': '-K',
                            'Met': 'M', '-Met': '-M',
                            'Phe': 'F', '-Phe': '-F',
                            'Pro': 'P', '-Pro': '-P',
                            'Ser': 'S?', '-Ser': '-S?',
                            'Thr': 'T', '-Thr': '-T',
                            'Trp': 'W', '-Trp': '-W',
                            'Tyr': 'Y', '-Tyr': '-Y',
                            'Val': 'V', '-Val': '-V',
                            
                        };
                        const _createInputFile = document.getElementById('createInputFile').value;
                        const _data = Object.keys(data);
                        let dataSeq = '';

                        _data.forEach((id) => {
                            let _geneOrder = data[id].geneOrder;
                            let _geneOrderUnique = [...new Set(_geneOrder.split(','))].join(',');

                            if (!geneOrderCounts[_geneOrderUnique]) {
                                geneOrderCounts[_geneOrderUnique] = 0;
                            }
                            geneOrderCounts[_geneOrderUnique]++;
                        });

                        _data.forEach((id) => {
                            let _geneOrder = data[id].geneOrder
                                .split(',')
                                .filter(gene => gene.trim() !== '-') // Remove standalone '-'
                                .join(',');
                            
                            let _geneOrderUnique = [...new Set(_geneOrder.split(','))].join(',');

                            switch (_createInputFile) {
                                case 'CREx':
                                    _geneOrderUnique = _geneOrderUnique.split(',').map(gene => geneMapQmgr[gene] || gene).join(' ');
                                    dataSeq += `>${data[id].vouchers}_${data[id].speciesNames}\n${_geneOrderUnique}\n`;
                                    break;
                                case 'qMGR':
                                    let count = geneOrderCounts[_geneOrderUnique];
                                    _geneOrderUnique = _geneOrderUnique.split(',').map(gene => geneMapQmgr[gene] || gene).join(',');
                                    dataSeq += `>${data[id].vouchers}_${data[id].speciesNames}\n${count},${_geneOrderUnique}\n`;
                                    break;
                                default:
                                    console.error('Unknown tool selected');
                                    break;
                            }
                        });




                    const blob = new Blob([dataSeq], { type: 'text/plain' });
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'PUMAS_' + _createInputFile + '.txt';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                });

                const downloadPlot = document.getElementById('PatternsDownload');
                const PatternsSelect = document.getElementById('PatternsSelect');
                downloadPlot.addEventListener('click', function () {
                    let geneStart     = document.getElementById('geneList').value;
                    if (PatternsSelect.value === 'SVG') {
                        createAndDownloadSVG(data, _geneListEdit, geneStart);
                    } else if (PatternsSelect.value === 'PNG') {
                        createAndDownloadPNG(data, _geneListEdit, geneStart);
                    }

                });
                    

                });
            </script>
            
            <div id="PUMASResults" style="display: none;" class="mt-2 container-fluid mx-auto">
                <hr>
                <label class="h4"><span class="badge text-bg-dark">5</span> - Export Results</label>
                <div class="row row-cols-1 row-cols-sm-1 row-cols-md-2 row-cols-lg-2 row-cols-xl-2 row-cols-xxl-2 mb-5">

                    <div class="col mt-2">
                        <label class="h5" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-custom-class="custom-tooltip" data-bs-html="true" data-bs-title="Select a <b>gene</b> to <b>create an fasta file</b>"><span class="badge text-bg-dark">5.1</span> - Fasta File</label>
                        <div class="input-group">
                            <select id="genesToFasta" class="form-select form-select-lg" id="fastaFileExport" aria-label=""></select>
                            <button id="downloadFasta" class="btn btn-dark" type="button" disabled>Download File</button>
                        </div>
                    </div>

                    <div class="col mt-2">
                        <label class="h5" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-custom-class="custom-tooltip" data-bs-html="true" data-bs-title="Select a <b>format</b> to <b>create an Plot</b>"><span class="badge text-bg-dark">5.2</span> - Create an Input File</label>
                        <div class="input-group">
                            <select id="createInputFile" class="form-select form-select-lg" aria-label="">
                                <option value="NaN" selected>Select a tool</option>
                                <option value="CREx">CREx / CREx2 / TreeREx</option>
                                <option value="qMGR">qMGR</option>
                            </select>
                            <button id="downloadInputFile" class="btn btn-dark" type="button" disabled>Download File</button>
                        </div>
                        <div id="textInfo" style="display: none; text-align: justify;"></div>
                        <script>
                            $(document).ready(function () {
                                const createInputFile = document.getElementById('createInputFile');
                                const txt = document.getElementById('textInfo');
                                createInputFile.addEventListener('change', function () {
                                   if (createInputFile.value === 'CREx') {
                                        txt.style.display = 'block';
                                        txt.innerHTML = '';
                                        txt.innerHTML = '<i class="fa-solid fa-circle-info"></i> Note that, the downloaded file should be edited, as any duplicated genes must be renamed (i.e. Leu1 and Leu2) or only one copy is permitted (one copy should be deleted for each duplicated genes) for CREx/CREx2/TreeREx to work properly.';
                                    } else if (createInputFile.value === 'qMGR') {
                                        txt.style.display = 'block';
                                        txt.innerHTML = '';
                                        txt.innerHTML = '<i class="fa-solid fa-circle-info"></i> Note that, the downloaded file should be edited. The user must edit the file to inform important issues, such as: there are two Leucines, so the user should inform which copy is L1, as well as L2.';
                                    } else {
                                        txt.style.display = 'none';
                                    }
                                });
                            });
                        </script>
                    </div>

                    <div class="col mt-2">
                        <label class="h5" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-custom-class="custom-tooltip" data-bs-html="true" data-bs-title="This is the puzzlelike figure observed below, that is, the data obtained directly from the gene order, with or without modifications (like gaps introduced by the user) of all genomes or solely the genome patterns."><span class="badge text-bg-dark">5.3</span> - Create a Puzzlelike Plot (image below)*</label>
                        <div class="input-group">
                            <select id="genesToPlot" class="form-select form-select-lg" aria-label="">
                                <option value="SVG" selected>SVG</option>
                                <option value="PNG">PNG</option>
                                <!--<option value="PDF">PDF</option>-->
                            </select>
                            <button id="downloadPlot" class="btn btn-dark" type="button">Download Plot</button>
                        </div>

                        <script>
                            $(document).ready(function () {
                                const downloadPlot = document.getElementById('downloadPlot');
                                const genesToPlot = document.getElementById('genesToPlot');
                                downloadPlot.addEventListener('click', function () {
                                    if (genesToPlot.value === 'PNG') {
                                        const svgElements   = Array.from(document.querySelectorAll('.svg-container svg'));
                                        const maxWidth      = Math.max(...svgElements.map(svg => svg.clientWidth));
                                        const totalHeight   = svgElements.reduce((sum, svg) => sum + svg.clientHeight, 0);
                                        mergeSVGsIntoPNG(svgElements, maxWidth, totalHeight);
                                    } else if (genesToPlot.value === 'SVG') {
                                        const svgElements   = Array.from(document.querySelectorAll('.svg-container svg'));
                                        downloadCombinedSVG(svgElements)
                                    
                                    } else if (genesToPlot.value === 'PDF') {
                                        const svgElements = Array.from(document.querySelectorAll('.svg-container svg'));
                                        mergeSVGsIntoPDF(svgElements);
                                    }
                             });
                            });
                        </script>
                    </div>

                    <div class="col mt-2">
                        <label class="h5" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-custom-class="custom-tooltip" data-bs-html="true" data-bs-title="Select a <b>gene</b> to <b>create a Individual plot</b>"><span class="badge text-bg-dark">5.4</span> - Create a Individual Plot</label>
                        <div class="input-group">
                            <select id="individualPlot" class="form-select form-select-lg" aria-label=""></select>
                            <button id="downloadIndivivualPlot" class="btn btn-dark" type="button" disabled>View Plot</button>
                        </div>
                    </div>

                </div>

                <label class="h4"><span class="badge text-bg-dark">6</span> - Genomes Patterns</label>
                <div class="row row-cols-2 row-cols-sm-1 row-cols-md-2 row-cols-lg-2 row-cols-xl-2 row-cols-xxl-2">
                    <div class="col-12 col-sm-12 col-md-3 col-lg-3 col-xl-3 col-xxl-3 mt-2 mb-2">
                        <label class="h4"><span class="badge text-bg-dark">6.1</span> - Show only Genome Patterns</label>
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" role="switch" id="Patterns">
                            <label class="form-check-label" for="Patterns">Show only Patterns</label>
                        </div>                          
                    </div>
                    <div class="col-12 col-sm-12 col-md-6 col-lg-6 col-xl-6 col-xxl-6 mt-2 mb-2">
                        <label class="h4"><span class="badge text-bg-dark">6.2</span> - Genome Patterns <b>(Final Figure for Publication)</b></label>
                        <div class="input-group">
                            <select id="PatternsSelect" class="form-select form-select-lg" aria-label="" disabled>
                                <option value="SVG" selected>SVG</option>
                                <option value="PNG">PNG</option>
                            </select>
                            <button id="PatternsDownload" class="btn btn-lg btn-dark" type="button" disabled>Download Figure</button>
                        </div>                    
                    </div>
                </div>
                <script>
                    $(document).ready(function () {
                        const PatternsSelect = document.getElementById('PatternsSelect');
                        const PatternsDownload = document.getElementById('PatternsDownload');
                        const Patterns = document.getElementById('Patterns');
                        Patterns.addEventListener('change', function () {
                            if (Patterns.checked) {
                                PatternsSelect.disabled = false;
                                PatternsDownload.disabled = false;
                            } else {
                                PatternsSelect.disabled = true;
                                PatternsDownload.disabled = true;
                            }
                        });
                    });
                </script>

            </div>

        </div>

        <div id="svgPlot"></div>

    </main>

    <div class="modal fade" id="ViewGenomeDraw" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-fullscreen">
            <div class="modal-content">
            <div class="modal-header bg-dark text-white">
            <h5 id="ViewPlotTitle" class="modal-title"></h5>
        </div>
        <div class="modal-body">
            <figure class="figure">
                <figcaption id="ViewPlotFigureCaption" class="figure-caption"></figcaption>
            </figure>
            <div id="LinearGenome"></div>
        </div>
        <div class="modal-footer bg-dark">
        <button type="button" class="btn btn-lg btn-light" id="ViewPlotColor">Invert Map Colors</button>
        <button type="button" class="btn btn-lg btn-light" id="ViewPlotFormat">Toggle Linear/Circular Format</button>
        <button type="button" class="btn btn-lg btn-light" id="ViewPlotDownload">Download PNG</button>
        <button type="button" class="btn btn-lg btn-danger" data-bs-dismiss="modal">Close</button></div>
        </div>
        </div>
    </div>

    <!-- Modal for adding a new gene -->
    <div class="modal fade" id="addGeneModal" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header h3 bg-dark text-white">Add a GAP, New Gene or Region</div>
                <div class="modal-body">
                    <div class="input-group mb-3">
                        <label class="input-group-text" for="geneNameInput">Choose a GAP, Gene or Region</label>
                        <select id="geneNameInput" class="form-select form-select-lg"></select>
                    </div>
                    <script>
                        $(document).ready(function () {
                            const mtGenes       = Object.keys(MitochondrialGenes).sort();
                            const cpGenes       = Object.keys(ChloroplastGenes).sort();
                            const startSearch   = document.getElementById('startSearch');
                            const mt            = document.getElementById('mt');
                            const cp            = document.getElementById('cp');
                            const geneNameInput = $('#geneNameInput');

                            startSearch.addEventListener('click', function () {
                                if (mt.checked) {
                                    geneNameInput.empty();
                                    mtGenes.forEach((gene) => {
                                        if (gene === '-'){
                                            geneNameInput.append($('<option>').text(`- (GAP)`).attr('value', ''))
                                        } else {
                                            geneNameInput.append($('<option>').text(gene).attr('value', gene))
                                        }
                                    });
                                } else if (cp.checked) {
                                    geneNameInput.empty();
                                    cpGenes.forEach((gene) => geneNameInput.append($('<option>').text(gene).attr('value', gene)));
                                }
                            });
                        });
                    </script>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" value="" id="light">
                        <label class="form-check-label" for="light">add in Light Strand <b>(+)</b> - <i class="fa-solid fa-circle-info"></i> Line Above Gene</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" value="" id="heavy">
                        <label class="form-check-label" for="heavy">add in Heavy Strand <b>(-)</b> - <i class="fa-solid fa-circle-info"></i> Line Below Gene</label>
                    </div>
                        <div class="input-group mb-3">
                            <span class="input-group-text">Number of Genes/Gaps/Region to add</span>
                            <input type="number" class="form-control" id="quantidade" min="1" max="10" value="1">
                        </div>
                    <script>
                        $(document).ready(function () {
                            const light = document.getElementById('light');
                            const heavy = document.getElementById('heavy');
                            light.addEventListener('change', function () {
                                if (light.checked) {
                                    heavy.checked = false;
                                }
                            });
                            heavy.addEventListener('change', function () {
                                if (heavy.checked) {
                                    light.checked = false;
                                }
                            });
                        });
                    </script>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-lg btn-danger" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-lg btn-primary" id="saveGeneButton">add the Gene or Region</button>
                </div>
            </div>
        </div>
    </div>


    <footer class="footer text-white bg-dark mt-5">
        <div class="container-fluid">
            <div class="row align-items-center">
                <div class="col-12 col-md-3 col-sm-1">
                    <div class="h4">About:</div>
                    <div class="media">
                        <img src="assets/PUMAS.png" class="mr-3 mx-auto d-block" alt="" width="35%">
                        <div class="media-body text-center"><p><b>Pu</b>zzle <b>M</b>itochondrial (and Chloroplast) <b>A</b>nalysis <b>S</b>cript</p></div>
                    </div>
                </div>
                <div class="col-12 col-md-5">
                    <div class="h4">Developers:</div>
                    <div class="row">
                        <div class="col-md-4 text-center">
                            <div class="media">
                                <img src="assets/Luan.png" class="mr-3 mx-auto d-block" alt="Luan Rabelo" width="25%">
                                <div class="media-body">
                                    <h5 class="mt-0">Luan Rabelo</h5>
                                    <p><i class="bi bi-envelope"></i> <a href="mailto:luanrabelo@outlook.com">luanrabelo@outlook.com</a></p>
                                    <p><i class="bi bi-twitter-x"></i> <a href="https://x.com/luanrabelo" target="_blank">@luanrabelo</a></p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 text-center">
                            <div class="media">
                                <img src="assets/Marcelo.png" class="mr-3 mx-auto d-block" alt="Marcelo Vallinoto"
                                    width="25%">
                                <div class="media-body">
                                    <h5 class="mt-0">Marcelo Vallinoto</h5>
                                    <p><i class="bi bi-envelope"></i> <a href="mailto:mvallino@ufpa.br">mvallino@ufpa.br</a></p>
                                    <p><i class="bi bi-twitter-x"></i> <a href="https://x.com/mvallinoto01" target="_blank">@mvallinoto01</a></p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 text-center">
                            <div class="media">
                                <img src="assets/Davidson.png" class="mr-3 mx-auto d-block" alt="Davidson SodrÃ©"
                                    width="25%">
                                <div class="media-body">
                                    <h5 class="mt-0">Davidson SodrÃ©</h5>
                                    <p><i class="bi bi-envelope"></i> <a href="mailto:davidson.sodre@ufra.edu.br">davidson.sodre@ufra.edu.br</a></p>
                                    <p><i class="bi bi-twitter-x"></i> <a href="https://x.com/_DSodre_" target="_blank">@_DSodre_</a></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-4 verticalDivider">
                    <div class="h4">Institutions:</div>
                    <div class="row">
                        <div class="col-md-6 text-center">
                            <div class="media">
                                <img src="assets/UFPA.png" class="mr-3 mx-auto d-block"
                                    alt="Universidade Federal do ParÃ¡" width="30%">
                                <div class="media-body">
                                    <h5 class="mt-0">Universidade Federal do ParÃ¡</h5>
                                    <p><i class="bi bi-globe2"></i> <a href="https://ufpa.br/" target="_blank">Universidade Federal do ParÃ¡</a></p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 text-center">
                            <div class="media">
                                <img src="assets/LEVO.png" class="mr-3 mx-auto d-block" alt="LaboratÃ³rio de EvoluÃ§Ã£o"
                                    width="30%">
                                <div class="media-body">
                                    <h5 class="mt-0">LaboratÃ³rio de EvoluÃ§Ã£o</h5>
                                    <p><i class="bi bi-globe2"></i> <a href="https://levo.ufpa.br/" target="_blank">LaboratÃ³rio de EvoluÃ§Ã£o</a></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <small class="text-center bg-white text-black">PUMAS Page was created by Luan Rabelo.</small>
            </div>
        </div>
    </footer>
</body>
<script src="PUMAS.js"></script>
<script>
    $(document).ready(function () {
        $('[data-bs-toggle="tooltip"]').tooltip();
    });
</script>
</html>